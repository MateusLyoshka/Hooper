generator client {
    provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Player {
    playerId        String    @id @db.Uuid @default(uuid())
    nomePlayer      String    @db.VarChar(255)
    numeroCelular   String    @db.VarChar(255)
    email           String    @unique @db.VarChar(255)
    CPF             String    @unique @db.VarChar(255)
    password        String    @db.VarChar(255)
    confirmPassword String    @db.VarChar(255)
    confirmEmail    String    @db.VarChar(255)
    createdAt       DateTime  @default(now())
    updatedAt       DateTime  @default(now())

    // Relação muitos-para-muitos com game via tabela intermediária
    games           PlayerGame[]

    // Relação um-para-um com stats (definindo fields e references)
    stat            Stats?    @relation(fields: [statId], references: [statId])
    statId          String?   @db.Uuid @unique

    @@map("players")
}

model Game {
    gameId     String     @id @db.Uuid @default(uuid())
    gameName   String      @db.VarChar(255)
    startTime  DateTime
    endTime    DateTime?

    // Relação muitos-para-muitos com player via tabela intermediária
    players    PlayerGame[]

    @@map("games")
}

// Tabela intermediária para a relação muitos-para-muitos entre player e game
model PlayerGame {
    playerId   String   @db.Uuid
    gameId     String   @db.Uuid

    player     Player   @relation(fields: [playerId], references: [playerId])
    game       Game     @relation(fields: [gameId], references: [gameId])

    @@id([playerId, gameId]) // Definir chave composta para garantir unicidade
    @@map("players_games")   // Nome da tabela no banco de dados
}

model Stats {
    statId        String   @id @db.Uuid @default(uuid()) 
    gamesplayed   Int
    gameswon      Int
    points        Int
    assists       Int
    rebounds      Int
    blocks        Int
    position      String   @db.VarChar(255)
    height        String   @db.VarChar(255) @default("0")
    dominantHand  String   @db.VarChar(255)

    // Relação um-para-um com player (não precisa definir fields e references aqui)
    player        Player?

    @@map("stats")
}
